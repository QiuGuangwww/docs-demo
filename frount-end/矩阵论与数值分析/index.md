# 矩阵论与数值分析
## 1.绪论与前置知识
### 1.1 误差分析与数值方法的稳定性
#### 1.1.1 误差的来源与分类
![误差图](https://s21.ax1x.com/2025/03/18/pEd4o6I.png)

由上图我们可知在科学计算中，误差的来源主要为以下几种：  
**1.模型误差**  
由实际问题抽象到数学模型会简化很多条件，不可避免的会产生误差，这种误差即为模型误差。  
**2.观测误差**  
观测手段限制，得到的数据带来的误差，即为观测误差。  
**3.截断误差**    
从数学问题转化为数值问题时带来的误差，即为截断误差。  
**4.舍入误差**    
用计算机进行数值计算的时候，由于计算机的字长有限，原始数据在计算机上的表现出现误差，这种误差称为舍入误差。  
#### 1.1.2 误差的基本概念与有效数字
**1.误差的基本概念**
- 设实数$x$为某个精确值，$a$ 为它的一个近似值，则称$x - a$为近似值 $a$ 的**绝对误差**，简称为**误差**。当 $x \neq 0$ 时，$\frac{x - a}{x}$称为$ a$ 的**相对误差**。
例如，当$x = 3.000$，$a = 3.100$ 时，绝对误差 $x - a = -0.100$，相对误差为
$$
\frac{x - a}{x} = \frac{-0.100}{3.00} \approx -0.0333 = -0.333 \times 10^{-1}.
$$
又当 $x = 3000.0$，$a = 0.3100 \times 10^4$时，绝对误差变化为$x - a = -0.1 \times 10^3$ ，而相对误差仍为
$$
\frac{x - a}{x} = \frac{-0.1 \times 10^3}{0.3000 \times 10^4} \approx -0.333 \times 10^{-1}.
$$

- 设实数$x$为某个精确值，$a$为它的一个近似值。若有常数$e_a$使得$|x-a|\leq e_a$，则称$e_a$为$a$的**绝对误差界**，或简称**误差界**，称$\frac{e_a}{|a|}$为$a$的**相对误差界**。   

 **2.有效数字**   
 - 设实数$x$为某个精确值，$a$为它的一个近似值，写成$a=\pm 10^k \times 0.a_1a_2a_3...a_n...$，它可以使有限或者无限小数的形式。其中$a_i (i=1,2,...)$是$0,1,...,9$中的一个数字，$a_1 \neq 0$，$k$为整数。若$|x-a| \leq \frac{1}{2} \times 10^{n-k}$，则称$a$为$x$的有$n$位**有效数字的近似值。**
 - 设实数$x$为某个精确值，$a$为它的一个近似值，写成$a=\pm 10^k \times 0.a_1a_2a_3...a_n...$。则：  
 （1）若$a$有$n$位有效数字，则$\frac{|x-a|}{|a|} \leq \frac{1}{2a_1} \times 10^{1-n}$。    
 （2）若$\frac{|x-a|}{|a|} \leq \frac{1}{2(a_1+1)} \times 10^{1-n}$，则$a$**至少**具有$n$位有效数字。  
#### 1.1.3 函数的误差估计 
用$Taylor$展开估计误差。
**1.一元函数的情形**
设一元函数 $f(x)$ 具有二阶连续导数，自变量$x$ 的一个近似值为 $a$。我们用 $f(a)$ 近似$f(x)$，可以用 $Taylor$ 展开的方法来估计其误差

$$
|f(x) - f(a)| \leq |f'(a)| |x - a| + \frac{|f''(\xi)|}{2} |x - a|^2,
$$

其中 $\xi$ 在 $x$ 与 $a$ 之间。如果 $f'(a) \neq 0$，$|f''(\xi)|$ 与 $|f'(a)|$ 相比不太大，则可忽略$|x - a|$ 的二次项，就得到近似函数值 $f(a)$ 的误差界和相对误差界估计式为

$$
|f(x) - f(a)| \leq |f'(a)| e_a,
$$
和
$$
\frac{|f(x) - f(a)|}{|f(a)|} \leq \frac{|f'(a)|}{|f(a)|} e_a,
$$

其中$e_a$ 为$a$ 的误差界。  

**多元函数的情形**
**多变量函数的误差估计**
如果$f(x_1, x_2, \cdots, x_n)$为 $n$ 元函数，自变量$x_1, x_2, \cdots, x_n$ 的近似值分别为 $a_1, a_2, \cdots, a_n$，则

$$
f(x_1, x_2, \cdots, x_n) - f(a_1, a_2, \cdots, a_n) \approx \sum_{k=1}^{n} \left( \frac{\partial f}{\partial x_k} \right)_a (x_k - a_k),
$$

其中 $\left( \frac{\partial f}{\partial x_k} \right)_a = \frac{\partial}{\partial x_k} f(a_1, a_2, \cdots, a_n)$，所以可以估计到函数值的误差界，近似地有

$$
|f(x_1, x_2, \cdots, x_n) - f(a_1, a_2, \cdots, a_n)| \leq \sum_{k=1}^{n} \left| \left( \frac{\partial f}{\partial x_k} \right)_a \right| |x_k - a_k|.
$$

#### 1.1.4数值方法的稳定性和避免误差危害的基本原则
**1. 数值方法的稳定性**   
用某一种数值方法计算一个问题的数值解，如果在方法的计算过程中舍入误差在一定条件下能够得到控制（或者说舍入误差的增长不影响产生可靠的结果），则称该算法是数值**稳定**的；否则，即出现与数值稳定相反的情况，则称之为数值**不稳定**的。  

**例：计算积分** $I_n = \int_0^1 \frac{x}{x+5} \, dx, \quad n = 0, 1, 2, \ldots, 7.$    

**解** 由于
$$
I_n + 5I_{n-1} = \int_0^1 \frac{x^n}{x+5} \, dx + 5 \int_0^1 \frac{x^{n-1}}{x+5} \, dx = \int_0^1 \frac{x^n + 5x^{n-1}}{x+5} \, dx = \int_0^1 x^{n-1} \, dx = \frac{1}{n}, 
$$   
所以
$$
 I_n = \frac{1}{n} - 5I_{n-1}, \quad (*) 
$$
利用$(*)$可以分别得到两种方法计算 $I_0, I_1, \ldots, I_7$ 的近似值。  

(1) 直接使用$(*)$，先计算$I_0 = \ln \frac{6}{5}$，然后依次计算$I_1, \ldots, I_7$。  

(2) 使用递推公式$I_{n-1} = \frac{1}{5} \left( \frac{1}{n} - I_n \right)$，先计算$I_7 \approx 0.0210$，然后计算$I_6, I_5, \ldots, I_0$。   

对这两种方法做数值稳定性分析：

设 $I_0$ 的近似值为 $I'_0$，然后按(1-15)计算$I_1, \ldots, I_7$ 的近似值$I'_1, \ldots, I'_7$，如果最初计算时误差为 $E_0 = I_0 - I'_0$，递推过程的舍入误差不计，并记$E_n = I_n - I'_n$，则有
$$
E_7 = I_7 - I'_7 = (-5)E_6 = (-5)(-5)E_5 = \cdots = (-5)^7 I E_0,
$$
由此可见，用方法(1)计算 $I_1, \ldots, I_7$ 时，当计算$I_0$ 时产生的舍入误差为$E_0$，那么计算$I_7$ 时产生的舍入误差放大了$5^7 = 78125$倍，因此，方法(1)是数值不稳定的。类似地，对方法(2)，如果在首先计算$I_7$ 时产生的舍入误差为 $E_7$，那么使用该公式计算 $I_0$ 时的误差却为
$$
E_0 = \left(-\frac{1}{5}\right)E_1 = \left(-\frac{1}{5}\right)\left(-\frac{1}{5}\right)E_2 = \cdots = \left(-\frac{1}{5}\right)^7 E_7. 
$$
由此可知，使用公式(2)计算时不会放大舍入误差。因此，方法(2)是数值稳定的。   
**2. 避免误差危害的基本原则**     
- 避免有效数字的损失  
  - 做加减运算时，应该防止大数吃小数
  - 避免两个相近的数相减
  - 避免小数字作除数或是大数作乘数
 
**例：(大数吃小数) 在五位十进制的计算机上计算**
$$
 x = 63015 + \sum_{i=1}^{1000} \delta_i,
$$
其中$\delta_i = 0.4$。

**解** 计算机做加减法时，先将所相加数阶码对齐，根据字长舍入，再加减。如果用63015依次加各个$\delta_i$，那么上式用规范化和阶码对齐后的数表示为
$$
x = 0.63015 \times 10^5 + 0.000004 \times 10^5 + \cdots + 0.000004 \times 10^5,
$$
因其中 $0.000004 \times 10^5$ 的舍入结果为$0$，所以上式的计算结果是$0.63015 \times 10^5$。这种现象被称为“大数吃小数”。如果改变运算次序，先把 1000 个$\delta_i$相加，再和 63015 相加，
$$
x = \underbrace{0.4 + 0.4 + \cdots + 0.4}_{1000} + 0.63015 \times 10^5 = 0.4 \times 10^3 + 0.63015 \times 10^5 $$
$$
= 0.004 \times 10^5 + 0.63015 \times 10^5 = 0.63415 \times 10^5. 
$$
显然，后一种方法的结果是正确的，前一种方法的舍入误差影响太大。 

- 减少运算次数也可以减少舍入误差的积累，于是引入多项式乘除法的**秦九韶算法**：   
**例：计算多项式** $p_n(x) = a_nx^n + a_{n-1}x^{n-1} + \cdots + a_1x + a_0$ 的值。

**解：** 如果采用直接逐项求和计算，则计算 $x, x^2, x^3, \ldots, x^n$时最少要用$n-1$次乘法，计算 $a_nx^n, a_{n-1}x^{n-1}, \ldots, a_1x$ 时要用 $n$ 次乘法，共计 $2n-1$ 次乘法。
其算法为：令$t_k = x \times t_{k-1},$ $u_k = u_{k-1} + a_k \times t_k,$$k = 1, 2, \ldots, n$和$\begin{cases} 
t_0 = 1, \\
u_0 = a_0. 
\end{cases}$
反复执行上述公式，最终得出的$u_n$ 就是所求的$p_n(x)$ 的值。总的计算量需进行$2n$次乘法。

若要更有效地求出多项式 $p_n(x)$ 的值，可采用嵌套乘法，即将$p_n(x)$写成等价形式：
$$p_n(x) = ((((((a_nx + a_{n-1})x + a_{n-2})x + \cdots + a_2)x + a_1)x + a_0.$$
上述对应于如下递推公式，即取$s_k = ((((((a_nx + a_{n-1})x + a_{n-2})x + \cdots + a_{k+1})x + a_k),$
则
$\begin{cases} s_{n} = a_{n}, \\ s_{k} = x s_{k + 1} + a_{k}, & k = n - 1, n - 2, \cdots, 2, 1, 0. \\ p_{n}(x) = s_{0}, \end{cases}$

反复执行上述公式，最终得出的$s_0$就是所求的$p_n(x)$的值。总的计算量需进行$n$次乘法。此方法被称为秦九韶算法，它比欧洲人$Horner$提出同类算法早 500 年。

### 1.2 向量与矩阵的范数

#### 1.2.1 向量范数

**定义及性质**
向量的范数是一个函数，它将向量映射到非负实数，满足以下性质：

1. **非负性**：
   $$\| \mathbf{x} \| \geq 0 \quad \text{且当且仅当} \quad \mathbf{x} = \mathbf{0} \quad \text{时，} \quad \| \mathbf{x} \| = 0$$

2. **齐次性（绝对齐次性）**：
   $$\| \alpha \mathbf{x} \| = |\alpha| \| \mathbf{x} \|$$
   对于任意标量$\alpha$。

3. **三角不等式（次可加性）**：
   $$\| \mathbf{x} + \mathbf{y} \| \leq \| \mathbf{x} \| + \| \mathbf{y} \|$$
   对于所有向量$\mathbf{x}$和$\mathbf{y}$。

**p-范数定义**
对于$\mathbb{C}^n$中的向量$\mathbf{x}$，其$p$-范数定义为：
$$\| \mathbf{x} \|_p = \left( \sum_{i=1}^n |x_i|^p \right)^{\frac{1}{p}}$$

**特殊情况**
- 当$p = 1$时，为1-范数（曼哈顿范数）：
  $$\| \mathbf{x} \|_1 = \sum_{i=1}^n |x_i|$$
- 当$p = 2$时，为2-范数（欧几里得范数）：
  $$\| \mathbf{x} \|_2 = \sqrt{\sum_{i=1}^n x_i^2}$$
- 当$p \to \infty$时，为无穷范数：
  $$\| \mathbf{x} \|_\infty = \max_{1 \leq i \leq n} |x_i|$$

**加权$p$-范数**
对于权重向量$\mathbf{w}$，加权$p$-范数定义为：
$$\| \mathbf{x} \|_{p,\mathbf{w}} = \left( \sum_{i=1}^n w_i |x_i|^p \right)^{\frac{1}{p}}$$

**范数连续性定理**  
定义在$\mathbb{C}^n$上的任何两个向量范数$\| \mathbf{x} \|$均为$\mathbf{x}$的连续函数。

**范数等价性定理**  
在有限维空间中，所有$p$-范数都是等价的，即存在常数$c_1, c_2 > 0$使得：
$$c_1 \| \mathbf{x} \|_q \leq \| \mathbf{x} \|_p \leq c_2 \| \mathbf{x} \|_q$$
对任意$1 \leq p, q \leq \infty$成立。

#### 1.2.2 矩阵范数

**定义及性质**
矩阵的范数是一个函数，它将矩阵映射到非负实数，满足以下性质：

1. **非负性**：
   $$\| A \| \geq 0 \quad \text{且当且仅当} \quad A = 0 \quad \text{时，} \quad \| A \| = 0$$

2. **齐次性（绝对齐次性）**：
   $$\| \alpha A \| = |\alpha| \| A \|$$
   对于任意标量$\alpha$。

3. **三角不等式（次可加性）**：
   $$\| A + B \| \leq \| A \| + \| B \|$$
   对于所有矩阵$A$和$B$。

4. **相容性**：
   $$\| AB \| \leq \| A \| \| B \|$$
   对于所有可乘矩阵$A$和$B$。



- **$M_1$范数**：
 $$
  \| A \|_{M_1} = \sum_{i=1}^m \sum_{j=1}^n |a_{ij}|
$$
  表示矩阵 \(A\) 的所有元素绝对值之和。

- **Frobenius范数**：
$$
  \| A \|_F = \sqrt{\sum_{i=1}^m \sum_{j=1}^n |a_{ij}|^2}
$$
  是矩阵所有元素的平方和的平方根，类似于向量的2-范数。

- **$M_\infty$ 范数**：
$$
  \| A \|_{M_\infty} = \max_{1 \leq i \leq m} \sum_{j=1}^n |a_{ij}|
$$
  表示矩阵 \(A\) 的每一行元素绝对值之和的最大值。


#### 1.2.3 算子范数

**定义**
算子范数是矩阵范数的一种推广，用于线性算子。对于线性算子$T$，其$p$-范数定义为：
$$\| T \|_p = \sup_{\| \mathbf{x} \|_p = 1} \| T \mathbf{x} \|_p$$

**特殊情况**
- 当$p = 1$时，为1-范数。
 - **1-范数（列和范数）**：
  $$\| A \|_1 = \max_{1 \leq j \leq n} \sum_{i=1}^m |a_{ij}|$$
- 当$p = \infty$时，为无穷范数。
- **无穷范数（行和范数）**：
  $$\| A \|_\infty = \max_{1 \leq i \leq m} \sum_{j=1}^n |a_{ij}|$$

**重点讨论$p = 2$**
当$p = 2$时，算子范数为矩阵的2-范数（**谱范数**）：
$$\| T \|_2 = \sqrt{\rho(T^* T)}$$
其中$\rho$表示矩阵的特征值的最大绝对值，$T^*$表示$T$的共轭转置。

#### 1.2.4相容矩阵的性质

相容矩阵的性质涉及到矩阵范数之间的相互关系，以及它们与矩阵运算的兼容性。这些性质对于理解和应用矩阵范数至关重要。

1. **相容性（Submultiplicative Property）**：
   对于任意两个矩阵$A$和$B$，它们的乘积的范数小于或等于各自范数的乘积：
   $$\| AB \| \leq \| A \| \| B \|$$
   这意味着矩阵乘法在范数意义下是连续的。

2. **逆矩阵的范数**：
   如果矩阵$A$可逆，则其逆矩阵的范数可以通过$A$的范数来界定：
   $$\| A^{-1} \| \leq \frac{1}{\| A \|_{\min}}$$
   其中，$\| A \|_{\min}$是$A$的最小奇异值。

3. **谱半径与矩阵范数的关系**：
   矩阵的谱半径$\rho(A)$与其任意诱导范数$\| \cdot \|$有如下关系：
   $$\rho(A) \leq \| A \|$$
   特别地，对于对称矩阵，谱范数等于2-范数。

**定理1**
对于任意给定的$\varepsilon > 0$，则存在$\mathbb{C}^{n \times n}$上的一种算子范数$\| \cdot \|$（依赖于矩阵$A$和常数$\varepsilon$），使得：
$$\| A \| \leq \rho(A) + \varepsilon.$$

**定理2**
设$A \in \mathbb{C}^{n \times n}$，如果有$\mathbb{C}^{n \times n}$上的一种矩阵范数$\| \cdot \|$使得$\| A \| < 1$，则：
1. 矩阵$I \pm A$可逆；
2. $\| (I \pm A)^{-1} \| \leq \frac{\| I \|}{1 - \| A \|}$；
3. $\| A(I \pm A)^{-1} \| \leq \frac{\| A \|}{1 - \| A \|}$。