# 矩阵论与数值分析
## 1.绪论与前置知识
### 1.1 误差分析与数值方法的稳定性
#### 1.1.1 误差的来源与分类
![误差图](https://s21.ax1x.com/2025/03/18/pEd4o6I.png)

由上图我们可知在科学计算中，误差的来源主要为以下几种：  
**1.模型误差**  
由实际问题抽象到数学模型会简化很多条件，不可避免的会产生误差，这种误差即为模型误差。  
**2.观测误差**  
观测手段限制，得到的数据带来的误差，即为观测误差。  
**3.截断误差**    
从数学问题转化为数值问题时带来的误差，即为截断误差。  
**4.舍入误差**    
用计算机进行数值计算的时候，由于计算机的字长有限，原始数据在计算机上的表现出现误差，这种误差称为舍入误差。  
#### 1.1.2 误差的基本概念与有效数字
**1.误差的基本概念**
- 设实数$x$为某个精确值，$a$ 为它的一个近似值，则称$x - a$为近似值 $a$ 的**绝对误差**，简称为**误差**。当 $x \neq 0$ 时，$\frac{x - a}{x}$称为$ a$ 的**相对误差**。
例如，当$x = 3.000$，$a = 3.100$ 时，绝对误差 $x - a = -0.100$，相对误差为
$$
\frac{x - a}{x} = \frac{-0.100}{3.00} \approx -0.0333 = -0.333 \times 10^{-1}.
$$
又当 $x = 3000.0$，$a = 0.3100 \times 10^4$时，绝对误差变化为$x - a = -0.1 \times 10^3$ ，而相对误差仍为
$$
\frac{x - a}{x} = \frac{-0.1 \times 10^3}{0.3000 \times 10^4} \approx -0.333 \times 10^{-1}.
$$

- 设实数$x$为某个精确值，$a$为它的一个近似值。若有常数$e_a$使得$|x-a|\leq e_a$，则称$e_a$为$a$的**绝对误差界**，或简称**误差界**，称$\frac{e_a}{|a|}$为$a$的**相对误差界**。   

 **2.有效数字**   
 - 设实数$x$为某个精确值，$a$为它的一个近似值，写成$a=\pm 10^k \times 0.a_1a_2a_3...a_n...$，它可以使有限或者无限小数的形式。其中$a_i (i=1,2,...)$是$0,1,...,9$中的一个数字，$a_1 \neq 0$，$k$为整数。若$|x-a| \leq \frac{1}{2} \times 10^{n-k}$，则称$a$为$x$的有$n$位**有效数字的近似值。**
 - 设实数$x$为某个精确值，$a$为它的一个近似值，写成$a=\pm 10^k \times 0.a_1a_2a_3...a_n...$。则：  
 （1）若$a$有$n$位有效数字，则$\frac{|x-a|}{|a|} \leq \frac{1}{2a_1} \times 10^{1-n}$。    
 （2）若$\frac{|x-a|}{|a|} \leq \frac{1}{2(a_1+1)} \times 10^{1-n}$，则$a$**至少**具有$n$位有效数字。  
#### 1.1.3 函数的误差估计 
用$Taylor$展开估计误差。
**1.一元函数的情形**
设一元函数 $f(x)$ 具有二阶连续导数，自变量$x$ 的一个近似值为 $a$。我们用 $f(a)$ 近似$f(x)$，可以用 $Taylor$ 展开的方法来估计其误差

$$
|f(x) - f(a)| \leq |f'(a)| |x - a| + \frac{|f''(\xi)|}{2} |x - a|^2,
$$

其中 $\xi$ 在 $x$ 与 $a$ 之间。如果 $f'(a) \neq 0$，$|f''(\xi)|$ 与 $|f'(a)|$ 相比不太大，则可忽略$|x - a|$ 的二次项，就得到近似函数值 $f(a)$ 的误差界和相对误差界估计式为

$$
|f(x) - f(a)| \leq |f'(a)| e_a,
$$
和
$$
\frac{|f(x) - f(a)|}{|f(a)|} \leq \frac{|f'(a)|}{|f(a)|} e_a,
$$

其中$e_a$ 为$a$ 的误差界。  

**多元函数的情形**
**多变量函数的误差估计**  
如果$f(x_1, x_2, \cdots, x_n)$为 $n$ 元函数，自变量$x_1, x_2, \cdots, x_n$ 的近似值分别为 $a_1, a_2, \cdots, a_n$，则

$$
f(x_1, x_2, \cdots, x_n) - f(a_1, a_2, \cdots, a_n) \approx \sum_{k=1}^{n} \left( \frac{\partial f}{\partial x_k} \right)_a (x_k - a_k),
$$

其中 $\left( \frac{\partial f}{\partial x_k} \right)_a = \frac{\partial}{\partial x_k} f(a_1, a_2, \cdots, a_n)$，所以可以估计到函数值的误差界，近似地有

$$
|f(x_1, x_2, \cdots, x_n) - f(a_1, a_2, \cdots, a_n)| \leq \sum_{k=1}^{n} \left| \left( \frac{\partial f}{\partial x_k} \right)_a \right| |x_k - a_k|.
$$

#### 1.1.4数值方法的稳定性和避免误差危害的基本原则
**1. 数值方法的稳定性**   
用某一种数值方法计算一个问题的数值解，如果在方法的计算过程中舍入误差在一定条件下能够得到控制（或者说舍入误差的增长不影响产生可靠的结果），则称该算法是数值**稳定**的；否则，即出现与数值稳定相反的情况，则称之为数值**不稳定**的。  

**例：计算积分** $I_n = \int_0^1 \frac{x}{x+5} \, dx, \quad n = 0, 1, 2, \ldots, 7.$    

**解** 由于
$$
I_n + 5I_{n-1} = \int_0^1 \frac{x^n}{x+5} \, dx + 5 \int_0^1 \frac{x^{n-1}}{x+5} \, dx = \int_0^1 \frac{x^n + 5x^{n-1}}{x+5} \, dx = \int_0^1 x^{n-1} \, dx = \frac{1}{n}, 
$$   
所以
$$
 I_n = \frac{1}{n} - 5I_{n-1}, \quad (*) 
$$
利用$(*)$可以分别得到两种方法计算 $I_0, I_1, \ldots, I_7$ 的近似值。  

(1) 直接使用$(*)$，先计算$I_0 = \ln \frac{6}{5}$，然后依次计算$I_1, \ldots, I_7$。  

(2) 使用递推公式$I_{n-1} = \frac{1}{5} \left( \frac{1}{n} - I_n \right)$，先计算$I_7 \approx 0.0210$，然后计算$I_6, I_5, \ldots, I_0$。   

对这两种方法做数值稳定性分析：

设 $I_0$ 的近似值为 $I'_0$，然后按(1-15)计算$I_1, \ldots, I_7$ 的近似值$I'_1, \ldots, I'_7$，如果最初计算时误差为 $E_0 = I_0 - I'_0$，递推过程的舍入误差不计，并记$E_n = I_n - I'_n$，则有
$$
E_7 = I_7 - I'_7 = (-5)E_6 = (-5)(-5)E_5 = \cdots = (-5)^7 I E_0,
$$
由此可见，用方法(1)计算 $I_1, \ldots, I_7$ 时，当计算$I_0$ 时产生的舍入误差为$E_0$，那么计算$I_7$ 时产生的舍入误差放大了$5^7 = 78125$倍，因此，方法(1)是数值不稳定的。类似地，对方法(2)，如果在首先计算$I_7$ 时产生的舍入误差为 $E_7$，那么使用该公式计算 $I_0$ 时的误差却为
$$
E_0 = \left(-\frac{1}{5}\right)E_1 = \left(-\frac{1}{5}\right)\left(-\frac{1}{5}\right)E_2 = \cdots = \left(-\frac{1}{5}\right)^7 E_7. 
$$
由此可知，使用公式(2)计算时不会放大舍入误差。因此，方法(2)是数值稳定的。   
**2. 避免误差危害的基本原则**     
- 避免有效数字的损失  
  - 做加减运算时，应该防止大数吃小数
  - 避免两个相近的数相减
  - 避免小数字作除数或是大数作乘数
 
**例：(大数吃小数) 在五位十进制的计算机上计算**
$$
 x = 63015 + \sum_{i=1}^{1000} \delta_i,
$$
其中$\delta_i = 0.4$。

**解** 计算机做加减法时，先将所相加数阶码对齐，根据字长舍入，再加减。如果用63015依次加各个$\delta_i$，那么上式用规范化和阶码对齐后的数表示为
$$
x = 0.63015 \times 10^5 + 0.000004 \times 10^5 + \cdots + 0.000004 \times 10^5,
$$
因其中 $0.000004 \times 10^5$ 的舍入结果为$0$，所以上式的计算结果是$0.63015 \times 10^5$。这种现象被称为“大数吃小数”。如果改变运算次序，先把 1000 个$\delta_i$相加，再和 63015 相加，
$$
x = \underbrace{0.4 + 0.4 + \cdots + 0.4}_{1000} + 0.63015 \times 10^5 = 0.4 \times 10^3 + 0.63015 \times 10^5 $$
$$
= 0.004 \times 10^5 + 0.63015 \times 10^5 = 0.63415 \times 10^5. 
$$
显然，后一种方法的结果是正确的，前一种方法的舍入误差影响太大。 

- 减少运算次数也可以减少舍入误差的积累，于是引入多项式乘除法的**秦九韶算法**：   
**例：计算多项式** $p_n(x) = a_nx^n + a_{n-1}x^{n-1} + \cdots + a_1x + a_0$ 的值。

**解：** 如果采用直接逐项求和计算，则计算 $x, x^2, x^3, \ldots, x^n$时最少要用$n-1$次乘法，计算 $a_nx^n, a_{n-1}x^{n-1}, \ldots, a_1x$ 时要用 $n$ 次乘法，共计 $2n-1$ 次乘法。
其算法为：令$t_k = x \times t_{k-1},$ $u_k = u_{k-1} + a_k \times t_k,$$k = 1, 2, \ldots, n$和$\begin{cases} 
t_0 = 1, \\
u_0 = a_0. 
\end{cases}$
反复执行上述公式，最终得出的$u_n$ 就是所求的$p_n(x)$ 的值。总的计算量需进行$2n$次乘法。

若要更有效地求出多项式 $p_n(x)$ 的值，可采用嵌套乘法，即将$p_n(x)$写成等价形式：
$$p_n(x) = ((((((a_nx + a_{n-1})x + a_{n-2})x + \cdots + a_2)x + a_1)x + a_0.$$
上述对应于如下递推公式，即取$s_k = ((((((a_nx + a_{n-1})x + a_{n-2})x + \cdots + a_{k+1})x + a_k),$
则
$\begin{cases} s_{n} = a_{n}, \\ s_{k} = x s_{k + 1} + a_{k}, & k = n - 1, n - 2, \cdots, 2, 1, 0. \\ p_{n}(x) = s_{0}, \end{cases}$

反复执行上述公式，最终得出的$s_0$就是所求的$p_n(x)$的值。总的计算量需进行$n$次乘法。此方法被称为秦九韶算法，它比欧洲人$Horner$提出同类算法早 500 年。

### 1.2 向量与矩阵的范数

#### 1.2.1 向量范数

**定义及性质**
向量的范数是一个函数，它将向量映射到非负实数，满足以下性质：

1. **非负性**：
   $$\| \mathbf{x} \| \geq 0 \quad \text{且当且仅当} \quad \mathbf{x} = \mathbf{0} \quad \text{时，} \quad \| \mathbf{x} \| = 0$$

2. **齐次性（绝对齐次性）**：
   $$\| \alpha \mathbf{x} \| = |\alpha| \| \mathbf{x} \|$$
   对于任意标量$\alpha$。

3. **三角不等式（次可加性）**：
   $$\| \mathbf{x} + \mathbf{y} \| \leq \| \mathbf{x} \| + \| \mathbf{y} \|$$
   对于所有向量$\mathbf{x}$和$\mathbf{y}$。

**p-范数定义**
对于$\mathbb{C}^n$中的向量$\mathbf{x}$，其$p$-范数定义为：
$$\| \mathbf{x} \|_p = \left( \sum_{i=1}^n |x_i|^p \right)^{\frac{1}{p}}$$

**特殊情况**
- 当$p = 1$时，为1-范数（曼哈顿范数）：
  $$\| \mathbf{x} \|_1 = \sum_{i=1}^n |x_i|$$
- 当$p = 2$时，为2-范数（欧几里得范数）：
  $$\| \mathbf{x} \|_2 = \sqrt{\sum_{i=1}^n x_i^2}$$
- 当$p \to \infty$时，为无穷范数：
  $$\| \mathbf{x} \|_\infty = \max_{1 \leq i \leq n} |x_i|$$

**加权$p$-范数**
对于权重向量$\mathbf{w}$，加权$p$-范数定义为：
$$\| \mathbf{x} \|_{p,\mathbf{w}} = \left( \sum_{i=1}^n w_i |x_i|^p \right)^{\frac{1}{p}}$$

**范数连续性定理**  
定义在$\mathbb{C}^n$上的任何两个向量范数$\| \mathbf{x} \|$均为$\mathbf{x}$的连续函数。

**范数等价性定理**  
在有限维空间中，所有$p$-范数都是等价的，即存在常数$c_1, c_2 > 0$使得：
$$c_1 \| \mathbf{x} \|_q \leq \| \mathbf{x} \|_p \leq c_2 \| \mathbf{x} \|_q$$
对任意$1 \leq p, q \leq \infty$成立。

#### 1.2.2 矩阵范数

**定义及性质**
矩阵的范数是一个函数，它将矩阵映射到非负实数，满足以下性质：

1. **非负性**：
   $$\| A \| \geq 0 \quad \text{且当且仅当} \quad A = 0 \quad \text{时，} \quad \| A \| = 0$$

2. **齐次性（绝对齐次性）**：
   $$\| \alpha A \| = |\alpha| \| A \|$$
   对于任意标量$\alpha$。

3. **三角不等式（次可加性）**：
   $$\| A + B \| \leq \| A \| + \| B \|$$
   对于所有矩阵$A$和$B$。

4. **相容性**：
   $$\| AB \| \leq \| A \| \| B \|$$
   对于所有可乘矩阵$A$和$B$。



- **$M_1$范数**：
 $$
  \| A \|_{M_1} = \sum_{i=1}^m \sum_{j=1}^n |a_{ij}|
$$
  表示矩阵 \(A\) 的所有元素绝对值之和。

- **Frobenius范数**：
$$
  \| A \|_F = \sqrt{\sum_{i=1}^m \sum_{j=1}^n |a_{ij}|^2}
$$
  是矩阵所有元素的平方和的平方根，类似于向量的2-范数。

- **$M_\infty$ 范数**：
$$
  \| A \|_{M_\infty} = \max_{1 \leq i \leq m} \sum_{j=1}^n |a_{ij}|
$$
  表示矩阵 \(A\) 的每一行元素绝对值之和的最大值。


#### 1.2.3 算子范数

**定义**
算子范数是矩阵范数的一种推广，用于线性算子。对于线性算子$T$，其$p$-范数定义为：
$$\| T \|_p = \sup_{\| \mathbf{x} \|_p = 1} \| T \mathbf{x} \|_p$$

**特殊情况**
- 当$p = 1$时，为1-范数。
 - **1-范数（列和范数）**：
  $$\| A \|_1 = \max_{1 \leq j \leq n} \sum_{i=1}^m |a_{ij}|$$
- 当$p = \infty$时，为无穷范数。
- **无穷范数（行和范数）**：
  $$\| A \|_\infty = \max_{1 \leq i \leq m} \sum_{j=1}^n |a_{ij}|$$

**重点讨论$p = 2$**
当$p = 2$时，算子范数为矩阵的2-范数（**谱范数**）：
$$\| T \|_2 = \sqrt{\rho(T^* T)}$$
其中$\rho$表示矩阵的特征值的最大绝对值，$T^*$表示$T$的共轭转置。

#### 1.2.4相容矩阵的性质

相容矩阵的性质涉及到矩阵范数之间的相互关系，以及它们与矩阵运算的兼容性。这些性质对于理解和应用矩阵范数至关重要。

1. **相容性（Submultiplicative Property）**：
   对于任意两个矩阵$A$和$B$，它们的乘积的范数小于或等于各自范数的乘积：
   $$\| AB \| \leq \| A \| \| B \|$$
   这意味着矩阵乘法在范数意义下是连续的。

2. **逆矩阵的范数**：
   如果矩阵$A$可逆，则其逆矩阵的范数可以通过$A$的范数来界定：
   $$\| A^{-1} \| \leq \frac{1}{\| A \|_{\min}}$$
   其中，$\| A \|_{\min}$是$A$的最小奇异值。

3. **谱半径与矩阵范数的关系**：
   矩阵的谱半径$\rho(A)$与其任意诱导范数$\| \cdot \|$有如下关系：
   $$\rho(A) \leq \| A \|$$
   特别地，对于对称矩阵，谱范数等于2-范数。

**定理1**
对于任意给定的$\varepsilon > 0$，则存在$\mathbb{C}^{n \times n}$上的一种算子范数$\| \cdot \|$（依赖于矩阵$A$和常数$\varepsilon$），使得：
$$\| A \| \leq \rho(A) + \varepsilon.$$

**定理2**
设$A \in \mathbb{C}^{n \times n}$，如果有$\mathbb{C}^{n \times n}$上的一种矩阵范数$\| \cdot \|$使得$\| A \| < 1$，则：
1. 矩阵$I \pm A$可逆；
2. $\| (I \pm A)^{-1} \| \leq \frac{\| I \|}{1 - \| A \|}$；
3. $\| A(I \pm A)^{-1} \| \leq \frac{\| A \|}{1 - \| A \|}$。

## 2.矩阵的变换和计算
### 2.1 矩阵的三角分解及其应用
#### 2.1.1 Guass消去法与矩阵的LU分解
在线性代数中，我们已经了解过Gauss消去法，事实上，不论用手算还是计算机，Gauss消去法无疑是求解线性方程组$\mathbf {Ax=b}$的最简单和标准的方法。  
##### 1.Gauss消去法
Gauss 消去法是一种用于求解线性方程组的直接方法。它通过将系数矩阵化为上三角矩阵（行阶梯形），然后通过回代求解未知数。以下是 Gauss 消去法的步骤和相关内容。

**步骤**
1. **前向消元**：
   将线性方程组的系数矩阵通过初等行变换化为上三角矩阵。具体步骤如下：
   - 对于第$k$步（$k = 1, 2, \dots, n-1$），选择第$k$列中绝对值最大的元素作为主元（称为部分主元法）。
   - 通过初等行变换，将第$k$列中第$k$行以下的元素消为$0$。
   
   最终得到的上三角矩阵形式为：
   $$
   \begin{bmatrix}
   a_{11} & a_{12} & \cdots & a_{1n} \\
   0 & a_{22} & \cdots & a_{2n} \\
   \vdots & \vdots & \ddots & \vdots \\
   0 & 0 & \cdots & a_{nn}
   \end{bmatrix}
   $$
2. **回代求解**：
   从最后一个方程开始，依次求解未知数。具体步骤如下：
   - 对于第$i$个方程（$i = n, n-1, \dots, 1$），计算：
     $$
     x_i = \frac{b_i - \sum_{j=i+1}^n a_{ij} x_j}{a_{ii}}
     $$
     其中，$b_i$是方程组的常数项。

**示例**

考虑以下线性方程组：
$$
\begin{cases}
2x_1 + 3x_2 - x_3 = 5 \\
4x_1 + 4x_2 - 3x_3 = 3 \\
-2x_1 + 3x_2 - x_3 = 1
\end{cases}
$$

1. **前向消元**：
   - 第一步：将第一列的主元设为$4$（部分主元法），交换第一行和第二行。
   - 第二步：通过初等行变换，将第二行和第三行的第一列元素消为$0$。
   - 第三步：将第二列的主元设为$3$，通过初等行变换将第三行的第二列元素消为$0$。

   最终得到上三角矩阵：
   $$
   \begin{bmatrix}
   4 & 4 & -3 & 3 \\
   0 & 5 & -2.5 & 6.5 \\
   0 & 0 & 1.5 & 4.5
   \end{bmatrix}
   $$

2. **回代求解**：
   - 从第三个方程求解$x_3$：
     $$
     x_3 = \frac{4.5}{1.5} = 3
     $$
   - 代入第二个方程求解$x_2$：
     $$
     x_2 = \frac{6.5 - (-2.5) \cdot 3}{5} = 2
     $$
   - 代入第一个方程求解$x_1$：
     $$
     x_1 = \frac{3 - 4 \cdot 2 - (-3) \cdot 3}{4} = 1
     $$

   最终解为：
   $$
   x_1 = 1, \quad x_2 = 2, \quad x_3 = 3
   $$


:::tip
1. **主元选择**：
   在消元过程中，选择绝对值最大的元素作为主元（部分主元法），可以提高数值稳定性。
2. **奇异矩阵**：
   如果在消元过程中发现主元为$0$，则矩阵是奇异的，方程组无解或有无穷多解。
3. **计算复杂度**：
   Gauss 消去法的计算复杂度为$O(n^3)$，其中$n$是方程组的阶数。
:::
通过以上回顾，可以知道Guass消去法的基本思想即为通过初等行变换将增广矩阵$\mathbf{(A | b)}$化为上三角矩阵$\mathbf{(U | c)}$。然后通过回代求解。

##### 2.LU分解

LU 分解是将一个矩阵分解为一个下三角矩阵（Lower Triangular Matrix）和一个上三角矩阵（Upper Triangular Matrix）的乘积。即对于矩阵$A$，存在下三角矩阵$L$和上三角矩阵$U$，使得：
$$
A = LU
$$
LU 分解是求解线性方程组、计算矩阵行列式和逆矩阵的重要工具。当L为单位下三角矩阵时，我们称其为**Doolittle分解**，而当U为单位上三角矩阵时，我们称其为**Crout分解**。   
**定理：矩阵LU分解的存在和唯一性**   
如果$n$阶矩阵$A$的各阶顺序主子式都不为零，则$A$存在唯一的LU分解。

---

**LU 分解的步骤**

1. **初始化**：
   给定一个$n \times n$的矩阵$A$，目标是找到下三角矩阵$L$和上三角矩阵$U$，使得$A = LU$。

2. **高斯消元法**：
   通过高斯消元法将矩阵$A$化为上三角矩阵$U$，同时记录消元过程中使用的乘数，构造下三角矩阵$L$。

3. **构造$L$和$U$**：
   - $U$是高斯消元后得到的上三角矩阵。
   - $L$是一个单位下三角矩阵（对角线元素为$1$），其非对角线元素是消元过程中使用的乘数。

---

**LU 分解的计算公式**

LU 分解的递推公式如下：

1. **初始化**：
   - 设$A^{(0)} = A$。
   - $L$初始化为单位矩阵，$U$初始化为零矩阵。

2. **递推计算**：
   对于$k = 1, 2, \dots, n$，执行以下步骤：
   - 计算$U$的第$k$行：
     $$
     u_{kj} = a_{kj}^{(k-1)}, \quad j = k, k+1, \dots, n
     $$
   - 计算$L$的第$k$列：
     $$
     l_{ik} = \frac{a_{ik}^{(k-1)}}{u_{kk}}, \quad i = k+1, k+2, \dots, n
     $$
   - 更新矩阵$A^{(k)}$：
     $$
     a_{ij}^{(k)} = a_{ij}^{(k-1)} - l_{ik} \cdot u_{kj}, \quad i = k+1, \dots, n; \quad j = k+1, \dots, n
     $$

3. **最终结果**：
   - $U$是$A^{(n)}$的上三角部分。
   - $L$是单位下三角矩阵，其非对角线元素为$l_{ik}$。

---

**示例**

考虑矩阵$A$：
$$
A = \begin{bmatrix}
2 & 3 & 1 \\
4 & 7 & 5 \\
6 & 7 & 10
\end{bmatrix}
$$

1. **第一步消元**：
   - 计算乘数$l_{21} = \frac{4}{2} = 2$，$l_{31} = \frac{6}{2} = 3$。
   - 对第二行和第三行进行消元：
     $$
     \begin{aligned}
     \text{第二行} &= \text{第二行} - 2 \cdot \text{第一行} \\
     \text{第三行} &= \text{第三行} - 3 \cdot \text{第一行}
     \end{aligned}
     $$
   - 得到矩阵：
     $$
     A^{(1)} = \begin{bmatrix}
     2 & 3 & 1 \\
     0 & 1 & 3 \\
     0 & -2 & 7
     \end{bmatrix}
     $$

2. **第二步消元**：
   - 计算乘数$l_{32} = \frac{-2}{1} = -2$。
   - 对第三行进行消元：
     $$
     \text{第三行} = \text{第三行} - (-2) \cdot \text{第二行}
     $$
   - 得到矩阵：
     $$
     A^{(2)} = \begin{bmatrix}
     2 & 3 & 1 \\
     0 & 1 & 3 \\
     0 & 0 & 13
     \end{bmatrix}
     $$

3. **构造$L$和$U$**：
   - 上三角矩阵$U$：
     $$
     U = \begin{bmatrix}
     2 & 3 & 1 \\
     0 & 1 & 3 \\
     0 & 0 & 13
     \end{bmatrix}
     $$
   - 下三角矩阵$L$：
     $$
     L = \begin{bmatrix}
     1 & 0 & 0 \\
     2 & 1 & 0 \\
     3 & -2 & 1
     \end{bmatrix}
     $$

4. **验证$A = LU$**：
   $$
   LU = \begin{bmatrix}
   1 & 0 & 0 \\
   2 & 1 & 0 \\
   3 & -2 & 1
   \end{bmatrix}
   \begin{bmatrix}
   2 & 3 & 1 \\
   0 & 1 & 3 \\
   0 & 0 & 13
   \end{bmatrix}
   = \begin{bmatrix}
   2 & 3 & 1 \\
   4 & 7 & 5 \\
   6 & 7 & 10
   \end{bmatrix}
   = A
   $$

---

**LDU 分解**

LDU 分解是 LU 分解的进一步细化，将矩阵$A$分解为一个单位下三角矩阵$L$、一个对角矩阵$D$和一个单位上三角矩阵$U$的乘积，即：
$$
A = LDU
$$

1. **分解步骤**：
   - 首先进行 LU 分解，得到$A = LU$。
   - 将$U$分解为$U = DU'$，其中$D$是对角矩阵，$U'$是单位上三角矩阵。
   - 最终得到$A = LDU'$。

2. **示例**：
   对于上述示例中的$U$：
   $$
   U = \begin{bmatrix}
   2 & 3 & 1 \\
   0 & 1 & 3 \\
   0 & 0 & 13
   \end{bmatrix}
   $$
   可以分解为：
   $$
   D = \begin{bmatrix}
   2 & 0 & 0 \\
   0 & 1 & 0 \\
   0 & 0 & 13
   \end{bmatrix}, \quad
   U' = \begin{bmatrix}
   1 & 1.5 & 0.5 \\
   0 & 1 & 3 \\
   0 & 0 & 1
   \end{bmatrix}
   $$
   因此，$A = LDU'$。

---

:::info LU 分解的应用

1. **求解线性方程组**：
   对于线性方程组$A\mathbf{x} = \mathbf{b}$，可以通过 LU 分解将其转化为：
   $$
   L(U\mathbf{x}) = \mathbf{b}
   $$
   先解$L\mathbf{y} = \mathbf{b}$（前向替换），再解$U\mathbf{x} = \mathbf{y}$（回代）。

2. **计算行列式**：
   矩阵$A$的行列式可以通过$L$和$U$的行列式计算：
   $$
   \det(A) = \det(L) \cdot \det(U) = 1 \cdot \prod_{i=1}^n u_{ii}
   $$

3. **计算逆矩阵**：
   通过 LU 分解可以高效计算矩阵的逆。
   :::


::: tip 注意事项

1. **主元选择**：
   如果主元$a_{kk}^{(k)}$为$0$，则需要通过行交换（部分主元法）确保分解的稳定性。

2. **唯一性**：
   LU 分解在$L$为单位下三角矩阵且$A$非奇异时是唯一的。

3. **计算复杂度**：
   LU 分解的计算复杂度为$O(n^3)$，与高斯消元法相同。
:::

#### 2.1.2 Guass列主元消去法与带主元的LU分解
##### 1. Gauss 列主元消去法

Gauss 列主元消去法是高斯消元法的改进版本，通过选择列主元（即当前列中绝对值最大的元素）来避免数值不稳定性问题。以下是 Gauss 列主元消去法的步骤和相关内容。

---

**步骤**

1. **初始化**：
   给定一个$n \times n$的矩阵$A$和向量$\mathbf{b}$，目标是求解线性方程组$A\mathbf{x} = \mathbf{b}$。

2. **列主元选择**：
   对于第$k$步（$k = 1, 2, \dots, n-1$），在当前列$k$中选择绝对值最大的元素作为主元，并交换行以确保主元位于对角线位置。

3. **消元操作**：
   使用选定的主元对当前列$k$进行消元，将第$k$列中第$k$行以下的元素消为$0$。

4. **回代求解**：
   通过回代法求解上三角矩阵对应的线性方程组。

---

**示例**

考虑线性方程组：
$$
\begin{cases}
2x_1 + 3x_2 - x_3 = 5 \\
4x_1 + 4x_2 - 3x_3 = 3 \\
-2x_1 + 3x_2 - x_3 = 1
\end{cases}
$$

1. **第一步**：
   - 选择第一列中绝对值最大的元素$4$作为主元，交换第一行和第二行。
   - 消元后矩阵：
     $$
     \begin{bmatrix}
     4 & 4 & -3 & 3 \\
     2 & 3 & -1 & 5 \\
     -2 & 3 & -1 & 1
     \end{bmatrix}
     $$

2. **第二步**：
   - 选择第二列中绝对值最大的元素$3$作为主元，交换第二行和第三行。
   - 消元后矩阵：
     $$
     \begin{bmatrix}
     4 & 4 & -3 & 3 \\
     0 & 5 & -2.5 & 6.5 \\
     0 & 0 & 1.5 & 4.5
     \end{bmatrix}
     $$

3. **回代求解**：
   - 从第三个方程求解$x_3$：
     $$
     x_3 = \frac{4.5}{1.5} = 3
     $$
   - 代入第二个方程求解$x_2$：
     $$
     x_2 = \frac{6.5 - (-2.5) \cdot 3}{5} = 2
     $$
   - 代入第一个方程求解$x_1$：
     $$
     x_1 = \frac{3 - 4 \cdot 2 - (-3) \cdot 3}{4} = 1
     $$

   最终解为：
   $$
   x_1 = 1, \quad x_2 = 2, \quad x_3 = 3
   $$

---

##### 2.带主元的 LU 分解

带主元的 LU 分解是 LU 分解的改进版本，通过引入行交换（部分主元法）来避免数值不稳定性问题。其核心思想是在每一步消元中选择列主元，并记录行交换信息。  
**定理：** 对任意$n$阶矩阵$A$，均存在置换矩阵$P$、单位下三角矩阵$L$和上三角矩阵$U$，使得$PA=LU$

---

**步骤**

1. **初始化**：
   给定一个$n \times n$的矩阵$A$，目标是找到置换矩阵$P$、单位下三角矩阵$L$和上三角矩阵$U$，使得：
   $$
   PA = LU
   $$

2. **列主元选择**：
   对于第$k$步（$k = 1, 2, \dots, n-1$），在当前列$k$中选择绝对值最大的元素作为主元，并记录行交换信息。

3. **消元操作**：
   使用选定的主元对当前列$k$进行消元，将第$k$列中第$k$行以下的元素消为$0$。

4. **构造$L$和$U$**：
   - $U$是消元后得到的上三角矩阵。
   - $L$是单位下三角矩阵，其非对角线元素是消元过程中使用的乘数。
   - $P$是记录行交换信息的置换矩阵。

---

**示例**

考虑矩阵$A$：
$$
A = \begin{bmatrix}
2 & 3 & 1 \\
4 & 7 & 5 \\
6 & 7 & 10
\end{bmatrix}
$$

1. **第一步**：
   - 选择第一列中绝对值最大的元素$6$作为主元，交换第一行和第三行。
   - 消元后矩阵：
     $$
     A^{(1)} = \begin{bmatrix}
     6 & 7 & 10 \\
     4 & 7 & 5 \\
     2 & 3 & 1
     \end{bmatrix}
     $$

2. **第二步**：
   - 选择第二列中绝对值最大的元素$7$作为主元，交换第二行和第三行。
   - 消元后矩阵：
     $$
     A^{(2)} = \begin{bmatrix}
     6 & 7 & 10 \\
     0 & 1 & -3 \\
     0 & 0 & -5
     \end{bmatrix}
     $$

3. **构造$L$、$U$和$P$**：
   - 上三角矩阵$U$：
     $$
     U = \begin{bmatrix}
     6 & 7 & 10 \\
     0 & 1 & -3 \\
     0 & 0 & -5
     \end{bmatrix}
     $$
   - 下三角矩阵$L$：
     $$
     L = \begin{bmatrix}
     1 & 0 & 0 \\
     \frac{2}{3} & 1 & 0 \\
     \frac{1}{3} & 1 & 1
     \end{bmatrix}
     $$
   - 置换矩阵$P$：
     $$
     P = \begin{bmatrix}
     0 & 0 & 1 \\
     0 & 1 & 0 \\
     1 & 0 & 0
     \end{bmatrix}
     $$

4. **验证$PA = LU$**：
   $$
   PA = \begin{bmatrix}
   0 & 0 & 1 \\
   0 & 1 & 0 \\
   1 & 0 & 0
   \end{bmatrix}
   \begin{bmatrix}
   2 & 3 & 1 \\
   4 & 7 & 5 \\
   6 & 7 & 10
   \end{bmatrix}
   = \begin{bmatrix}
   6 & 7 & 10 \\
   4 & 7 & 5 \\
   2 & 3 & 1
   \end{bmatrix}
   $$
   $$
   LU = \begin{bmatrix}
   1 & 0 & 0 \\
   \frac{2}{3} & 1 & 0 \\
   \frac{1}{3} & 1 & 1
   \end{bmatrix}
   \begin{bmatrix}
   6 & 7 & 10 \\
   0 & 1 & -3 \\
   0 & 0 & -5
   \end{bmatrix}
   = \begin{bmatrix}
   6 & 7 & 10 \\
   4 & 7 & 5 \\
   2 & 3 & 1
   \end{bmatrix}
   $$



:::info 应用

1. **求解线性方程组**：
   带主元的 LU 分解可以高效求解线性方程组，尤其适用于数值不稳定的问题。

2. **计算行列式和逆矩阵**：
   通过带主元的 LU 分解可以计算矩阵的行列式和逆矩阵。
:::
#### 2.1.3 对称正定矩阵的Cholesky分解
##### 1.对称正定阵

**定义**

对称正定阵（Symmetric Positive Definite Matrix）是一类特殊的矩阵，满足以下条件：
1. **对称性**：矩阵$A$是对称矩阵，即$A = A^T$。
2. **正定性**：对于任意非零向量$\mathbf{x} \in \mathbb{R}^n$，有$\mathbf{x}^T A \mathbf{x} > 0$。


::: info 性质
1. 特征值：对称正定阵的所有特征值均为正数。
2. 行列式：对称正定阵的行列式为正数。
3. 主子矩阵：对称正定阵的所有主子矩阵也是正定矩阵。
4. 可逆性：对称正定阵是非奇异矩阵（可逆矩阵）。
:::


**示例**

考虑矩阵$A$：
$$
A = \begin{bmatrix}
4 & 2 \\
2 & 3
\end{bmatrix}
$$

1. **对称性**：
   $A$是对称矩阵，因为$A = A^T$。

2. **正定性**：
   对于任意非零向量$\mathbf{x} = [x_1, x_2]^T$，有：
   $$
   \mathbf{x}^T A \mathbf{x} = 4x_1^2 + 4x_1 x_2 + 3x_2^2 > 0
   $$
   因此，$A$是正定矩阵。

---

##### 2.Cholesky 分解

Cholesky 分解是将对称正定阵$A$分解为一个下三角矩阵$L$和其转置$L^T$的乘积，即：
$$
A = LL^T
$$

Cholesky 分解是 LU 分解的特例，适用于对称正定阵。

---

**步骤**

1. **初始化**：
   给定一个$n \times n$的对称正定阵$A$，目标是找到下三角矩阵$L$，使得$A = LL^T$。

2. **递推计算**：
   对于$i = 1, 2, \dots, n$，执行以下步骤：
   - 计算$L$的第$i$行对角线元素：
     $$
     l_{ii} = \sqrt{a_{ii} - \sum_{k=1}^{i-1} l_{ik}^2}
     $$
   - 计算$L$的第$i$行非对角线元素：
     $$
     l_{ji} = \frac{a_{ji} - \sum_{k=1}^{i-1} l_{jk} l_{ik}}{l_{ii}}, \quad j = i+1, \dots, n
     $$

---

**示例**

考虑对称正定阵$A$：
$$
A = \begin{bmatrix}
4 & 2 \\
2 & 3
\end{bmatrix}
$$

1. **第一步**：
   - 计算$l_{11}$：
     $$
     l_{11} = \sqrt{a_{11}} = \sqrt{4} = 2
     $$
   - 计算$l_{21}$：
     $$
     l_{21} = \frac{a_{21}}{l_{11}} = \frac{2}{2} = 1
     $$

2. **第二步**：
   - 计算$l_{22}$：
     $$
     l_{22} = \sqrt{a_{22} - l_{21}^2} = \sqrt{3 - 1} = \sqrt{2}
     $$

3. **构造$L$**：
   $$
   L = \begin{bmatrix}
   2 & 0 \\
   1 & \sqrt{2}
   \end{bmatrix}
   $$

4. **验证$A = LL^T$**：
   $$
   LL^T = \begin{bmatrix}
   2 & 0 \\
   1 & \sqrt{2}
   \end{bmatrix}
   \begin{bmatrix}
   2 & 1 \\
   0 & \sqrt{2}
   \end{bmatrix}
   = \begin{bmatrix}
   4 & 2 \\
   2 & 3
   \end{bmatrix}
   = A
   $$

---

:::tip Cholesky 分解的应用
1. **求解线性方程组**：
   对于线性方程组$A\mathbf{x} = \mathbf{b}$，可以通过 Cholesky 分解将其转化为：
   $$
   LL^T \mathbf{x} = \mathbf{b}
   $$
   先解$L\mathbf{y} = \mathbf{b}$（前向替换），再解$L^T \mathbf{x} = \mathbf{y}$（回代）。
2. **计算行列式**：
   矩阵$A$的行列式可以通过$L$的行列式计算：
   $$
   \det(A) = \det(L) \cdot \det(L^T) = \left( \prod_{i=1}^n l_{ii} \right)^2
   $$
3. **计算逆矩阵**：
   通过 Cholesky 分解可以高效计算矩阵的逆。
:::


:::warning 注意事项

1. **对称正定性**：
   Cholesky 分解仅适用于对称正定阵。如果矩阵不是对称正定的，Cholesky 分解将失败。

2. **数值稳定性**：
   Cholesky 分解具有较好的数值稳定性，适用于大规模科学计算。

3. **计算复杂度**：
   Cholesky 分解的计算复杂度为$O(n^3)$，但比 LU 分解更快。
:::
#### 2.1.3.5 LU分解手算法
事实上，上文给出的各种递推公式足以计算，但是那些公式对应试考生来说不仅难以记忆而且还容易混淆记错。上文给出的各种公式更多是为了方便计算机计算，而应试计算有更加适用于手算的算法。  
##### 1.LU与LDU
为节省存储空间，可将每次得到的$L$的元素$c_{jk} (j>k)$存放在矩阵$A^{(k+1)}$的$(j,k)$位置上，从而得到紧凑格式的$LU$分解求解方法

$$
\begin{array}{cccc}
A \sim & \left[ \begin{array}{ccc}
a_{11}^{(1)} & a_{12}^{(1)} & a_{13}^{(1)} & a_{1n}^{(1)} \\
c_{21} & a_{22}^{(2)} & a_{23}^{(2)} & a_{24}^{(2)} \\
c_{31} & a_{32}^{(2)} & a_{33}^{(2)} & a_{34}^{(2)} \\
c_{41} & a_{42}^{(2)} & a_{43}^{(2)} & a_{44}^{(2)}
\end{array} \right] \sim & \left[ \begin{array}{ccc}
a_{11}^{(1)} & a_{12}^{(1)} & a_{13}^{(1)} & a_{1n}^{(1)} \\
c_{21} & a_{22}^{(2)} & a_{23}^{(2)} & a_{24}^{(2)} \\
c_{31} & c_{32}^{(3)} & a_{33}^{(3)} & a_{34}^{(3)} \\
c_{41} & c_{42}^{(3)} & a_{43}^{(3)} & a_{44}^{(3)}
\end{array} \right] \sim & \left[ \begin{array}{ccc}
a_{11}^{(1)} & a_{12}^{(1)} & a_{13}^{(1)} & a_{1n}^{(1)} \\
c_{21} & a_{22}^{(2)} & a_{23}^{(2)} & a_{24}^{(2)} \\
c_{31} & c_{32}^{(3)} & a_{33}^{(3)} & a_{34}^{(3)} \\
c_{41} & c_{42}^{(4)} & c_{43}^{(4)} & a_{44}^{(4)}
\end{array} \right]
\end{array}
$$

则
$$
L = \left[ \begin{array}{cccc}
1 & 0 & 0 & 0 \\
c_{21} & 1 & 0 & 0 \\
c_{31} & c_{32} & 1 & 0 \\
c_{41} & c_{42} & c_{43} & 1 
\end{array} \right], \quad U = \left[ \begin{array}{cccc}
a_{11}^{(1)} & a_{12}^{(1)} & a_{13}^{(1)} & a_{1n}^{(1)} \\
0 & a_{22}^{(2)} & a_{23}^{(2)} & a_{24}^{(2)} \\
0 & 0 & a_{33}^{(3)} & a_{34}^{(3)} \\
0 & 0 & 0 & a_{44}^{(4)}
\end{array} \right]
$$

它的$LDU$分解为
$$
LDU = \left[ \begin{array}{cccc}
1 & 0 & 0 & 0 \\
c_{21} & 1 & 0 & 0 \\
c_{31} & c_{32} & 1 & 0 \\
c_{41} & c_{42} & c_{43} & 1 
\end{array} \right] \sim \left[ \begin{array}{cccc}
a_{11}^{(1)} & 0 & 0 & 0 \\
0 & a_{22}^{(2)} & 0 & 0 \\
0 & 0 & a_{33}^{(3)} & 0 \\
0 & 0 & 0 & a_{44}^{(4)}
\end{array} \right] \sim \left[ \begin{array}{cccc}
a_{11}^{(1)} & a_{12}^{(1)} / a_{11}^{(1)} & a_{13}^{(1)} / a_{11}^{(1)} & a_{1n}^{(1)} / a_{11}^{(1)} \\
0 & a_{22}^{(2)} & a_{23}^{(2)} / a_{22}^{(2)} & a_{24}^{(2)} / a_{22}^{(2)} \\
0 & 0 & a_{33}^{(3)} & a_{34}^{(3)} / a_{33}^{(3)} \\
0 & 0 & 0 & a_{44}^{(4)}
\end{array} \right]
$$

**例** 用紧凑格式求矩阵$A = \left[ \begin{array}{ccc}
2 & -1 & 3 \\
1 & 2 & 1 \\
2 & 4 & 3 
\end{array} \right]$的$LU$分解和$LDU$分解。

因此
$$
A = \left[ \begin{array}{ccc}
2 & -1 & 3 \\
1 & 2 & 1 \\
2 & 4 & 3 
\end{array} \right] \sim \left[ \begin{array}{ccc}
2 & -1 & 3 \\
1 & 5 & -\frac{1}{2} \\
1 & 5 & 0 
\end{array} \right] \sim \left[ \begin{array}{ccc}
2 & -1 & 3 \\
\frac{1}{2} & \frac{5}{2} & -\frac{1}{2} \\
1 & 2 & 1 
\end{array} \right]
$$

因此
$$
A = \left[ \begin{array}{cccc}
1 & 0 & 0 & 0 \\
\frac{1}{2} & 1 & 0 & 0 \\
1 & 2 & 1 & 0 
\end{array} \right] \sim \left[ \begin{array}{cccc}
2 & -1 & 3 \\
0 & \frac{5}{2} & -\frac{1}{2} \\
0 & 0 & 1 
\end{array} \right]
$$

$A$的$LDU$分解为
$$
A = \left[ \begin{array}{cccc}
1 & 0 & 0 & 0 \\
\frac{1}{2} & 1 & 0 & 0 \\
1 & 2 & 1 & 0 
\end{array} \right] \sim \left[ \begin{array}{cccc}
2 & 0 & 0 & 0 \\
0 & \frac{5}{2} & 0 & 0 \\
0 & 0 & 1 & 0 
\end{array} \right] \sim \left[ \begin{array}{cccc}
1 & -\frac{1}{2} & \frac{3}{2} \\
0 & 1 & -\frac{1}{5} & 0 \\
0 & 0 & 1 & 0 
\end{array} \right]
$$


##### 2.Cholesky分解
(1) 对 $A$ 进行 Doolittle 分解 $A=LU$;
(2) 选取 $U$ 的对角线元素 $d_1, d_2, \cdots, d_n$;
(3) 令 $G=L \cdot \text{diag}(\sqrt{d_1}, \sqrt{d_2}, \cdots, \sqrt{d_n})$;
(4) 写出 Cholesky 分解：$A=GG^T$.

例 1.3.4 求矩阵 $A=\begin{bmatrix} 5 & -2 & 0 \\ -2 & 3 & -1 \\ 0 & -1 & 1 \end{bmatrix}$ 的 Cholesky 分解和推广 Cholesky 分解。

解 $A=\begin{bmatrix} 5 & -2 & 0 \\ -2 & 3 & -1 \\ 0 & -1 & 1 \end{bmatrix} \sim \begin{bmatrix} 5 & -2 & 0 \\ -\frac{2}{5} & \frac{11}{5} & -1 \\ 0 & -\frac{5}{11} & \frac{6}{11} \end{bmatrix}$

因此 $A$ 的 Doolittle 分解为

$$
LW = \begin{bmatrix} 1 & 0 & 0 \\ -\frac{2}{5} & 1 & 0 \\ 0 & -\frac{5}{11} & 1 \end{bmatrix} \begin{bmatrix} 5 & -2 & 0 \\ 0 & \frac{11}{5} & -1 \\ 0 & 0 & \frac{6}{11} \end{bmatrix}
$$

$$
G = \begin{bmatrix} 1 & 0 & 0 \\ -\frac{2}{5} & 1 & 0 \\ 0 & -\frac{5}{11} & 1 \end{bmatrix} \begin{bmatrix} \sqrt{5} & 0 & 0 \\ 0 & \sqrt{\frac{11}{5}} & 0 \\ 0 & 0 & \sqrt{\frac{6}{11}} \end{bmatrix} = \begin{bmatrix} \sqrt{5} & 0 & 0 \\ -\frac{2\sqrt{5}}{5} & \sqrt{\frac{11}{5}} & 0 \\ 0 & -\sqrt{\frac{5}{11}} & \sqrt{\frac{6}{11}} \end{bmatrix}
$$

所以 Cholesky 分解为

$$
A = \begin{bmatrix} \sqrt{5} & 0 & 0 \\ -\frac{2}{5} & \sqrt{\frac{11}{5}} & 0 \\ 0 & -\sqrt{\frac{5}{11}} & \sqrt{\frac{6}{11}} \end{bmatrix} \begin{bmatrix} \sqrt{5} & -\frac{2}{5} & 0 \\ 0 & \sqrt{\frac{11}{5}} & -\sqrt{\frac{5}{11}} \\ 0 & 0 & \sqrt{\frac{6}{11}} \end{bmatrix}
$$

推广 Cholesky 分解为

$$
LDL^T = \begin{bmatrix} 1 & 0 & 0 \\ -\frac{2}{5} & 1 & 0 \\ 0 & -\frac{5}{11} & 1 \end{bmatrix} \begin{bmatrix} 5 & 0 & 0 \\ 0 & \frac{11}{5} & 0 \\ 0 & 0 & \frac{6}{11} \end{bmatrix} \begin{bmatrix} 1 & -\frac{2}{5} & 0 \\ 0 & 1 & -\frac{5}{11} \\ 0 & 0 & 1 \end{bmatrix}
$$